<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kwatire Government Hospital Staff Elections 2025 - April</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }
    .header {
      background-color: #28a745;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .header img {
      width: 100px;
      vertical-align: middle;
      margin-right: 10px;
    }
    .header h1 {
      display: inline;
      font-size: 24px;
    }
    .container {
      max-width: 900px;
      margin: 20px auto;
      padding: 20px;
      background-color: white;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    .form-group input {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }
    .parameter {
      color: #8b0000;
      font-weight: bold;
    }
    .score-group {
      margin: 20px 0;
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 8px;
      position: relative;
    }
    .score-group h3 {
      margin: 0 0 12px 0;
      font-size: 1.2em;
    }
    .score-group label {
      display: block;
      margin: 8px 0;
      padding: 8px;
      border-radius: 5px;
      cursor: pointer;
    }
    .score-group input[type="radio"] {
      margin-right: 12px;
    }
    .score-group input[type="radio"]:checked + span {
      background-color: #e0ffe0;
      font-weight: bold;
    }
    .clear-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: #dc3545;
      color: white;
      border: none;
      padding: 6px 12px;
      cursor: pointer;
      border-radius: 4px;
    }
    .clear-btn:hover {
      background-color: #c82333;
    }
    .nominee {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .nominee img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }
    .winner {
      color: #ffd700;
      font-weight: bold;
    }
    button {
      background-color: #28a745;
      color: white;
      padding: 12px 24px;
      border: none;
      cursor: pointer;
      margin: 8px 4px;
      border-radius: 5px;
      font-size: 1em;
    }
    button:hover {
      background-color: #218838;
    }
    .reset-btn {
      background-color: #6c757d;
    }
    .reset-btn:hover {
      background-color: #5a6268;
    }
    .summary-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 0.95em;
    }
    .summary-table th, .summary-table td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
    }
    .summary-table th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <div class="container" id="container"></div>

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
  <script>
    // Your Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCFgBeYSQkgYxy12dpzO0QFne271J_Gi6A",
      authDomain: "kgh-staff-elections.firebaseapp.com",
      databaseURL: "https://kgh-staff-elections-default-rtdb.firebaseio.com",
      projectId: "kgh-staff-elections",
      storageBucket: "kgh-staff-elections.firebasestorage.app",
      messagingSenderId: "733962213751",
      appId: "1:733962213751:web:93a8060d3c5555ee0e2972",
      measurementId: "G-7CH9GTZBD4"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    const parameters = [
      "PUNCTUALITY",
      "ATTITUDE TOWARDS WORK",
      "ATTITUDE TOWARDS COWORKERS",
      "DISCIPLINE",
      "INNOVATIVE",
      "DRESSING",
      "WILLINGNESS TO ACCEPT ADDITIONAL TASK"
    ];

    const scores = [
      { label: "GOOD", value: 1 },
      { label: "BETTER", value: 2 },
      { label: "BEST", value: 3 },
      { label: "OUTSTANDING", value: 4 },
      { label: "EXCEPTIONAL", value: 5 }
    ];

    const nominees = [
      { name: "Gloria Kyeraa" },
      { name: "Amos Doe" },
      { name: "Alpha Oteng" },
      { name: "Anthony Ansah Boakye" },
      { name: "Samuel Twene" }
    ];

    let step = 0;
    let voterDetails = { staffId: "", surname: "", middleName: "", otherName: "" };
    let votes = {};

    function render() {
      const container = document.getElementById("container");
      if (!container) {
        console.error("Container element not found!");
        document.body.innerHTML = "<p>Error: Page failed to load. Please check the console for details.</p>";
        return;
      }

      container.innerHTML = `
        <div class="header">
          <img src="https://i.imgur.com/jM246HZ.jpg" alt="Ghana Health Service Logo">
          <h1>KWATIRE GOVERNMENT HOSPITAL STAFF ELECTIONS 2025 (APRIL)</h1>
        </div>
      `;

      if (step === 0) {
        container.innerHTML += `
          <h2>Voter Details</h2>
          <div class="form-group">
            <label for="staffId">Staff ID <span class="required">*</span></label>
            <input type="text" id="staffId" placeholder="Enter your Staff ID" aria-required="true">
          </div>
          <div class="form-group">
            <label for="surname">Surname <span class="required">*</span></label>
            <input type="text" id="surname" placeholder="Enter your Surname" aria-required="true">
          </div>
          <div class="form-group">
            <label for="middleName">Middle Name</label>
            <input type="text" id="middleName" placeholder="Enter your Middle Name">
          </div>
          <div class="form-group">
            <label for="otherName">Other Name</label>
            <input type="text" id="otherName" placeholder="Enter your Other Name">
          </div>
          <button onclick="nextStep()">Next</button>
          <button onclick="viewResultsDirectly()">View Accumulated Results</button>
        `;
      } else if (step > 0 && step <= parameters.length) {
        const paramIndex = step - 1;
        const parameter = parameters[paramIndex];
        const currentVotes = votes[parameter] || {};

        container.innerHTML += `
          <h2>Vote for ${parameter}</h2>
          <p class="parameter">${parameter}</p>
          <p>Please assign each score to a different nominee (5 unique scores required):</p>
          ${scores.map(score => `
            <div class="score-group" role="radiogroup" aria-labelledby="score-${score.value}-${paramIndex}">
              <h3 id="score-${score.value}-${paramIndex}">${score.label} (${score.value})</h3>
              <button class="clear-btn" onclick="clearScore('${parameter}', ${score.value}, ${paramIndex})">Clear</button>
              ${nominees.map(nominee => {
                const isChecked = currentVotes[nominee.name] === score.value;
                const isDisabled = Object.keys(currentVotes).includes(nominee.name) && !isChecked;
                return `
                  <label>
                    <input type="radio"
                           name="score-${score.value}-${paramIndex}"
                           value="${nominee.name}"
                           ${isChecked ? 'checked' : ''}
                           ${isDisabled ? 'disabled' : ''}
                           onchange="recordVote('${parameter}', '${nominee.name}', ${score.value}, ${paramIndex})">
                    <span class="nominee">
                      <img src="https://via.placeholder.com/40x40?text=${nominee.name.charAt(0)}" alt="${nominee.name}">
                      ${nominee.name}
                    </span>
                  </label>
                `;
              }).join('')}
            </div>
          `).join('')}
          <button onclick="nextStep()">Next</button>
          <button class="reset-btn" onclick="resetVotes()">Reset All Votes</button>
        `;
      } else if (step === parameters.length + 1) {
        container.innerHTML += `
          <h2>Review Your Votes</h2>
          <table class="summary-table" role="table" aria-label="Vote Summary">
            <tr>
              <th scope="col">Parameter</th>
              ${nominees.map(n => `<th scope="col">${n.name}</th>`).join('')}
            </tr>
            ${parameters.map(param => `
              <tr>
                <td>${param}</td>
                ${nominees.map(n => `
                  <td>${votes[param]?.[n.name] ? scores.find(s => s.value === votes[param][n.name]).label : '-'}</td>
                `).join('')}
              </tr>
            `).join('')}
          </table>
          <button onclick="submitVotes()">Submit Votes</button>
          <button class="reset-btn" onclick="resetVotes()">Reset All Votes</button>
          <button onclick="calculateResults()">View Results</button>
          <button onclick="viewSubmittedVotes()">Admin: View Submitted Votes</button>
        `;
      } else if (step === parameters.length + 2) {
        container.innerHTML += `
          <h2>Submission Confirmation</h2>
          <p>YOUR VOTES HAS BEEN SUBMITTED, THANK U!!!</p>
        `;
      }
    }

    // Rest of your functions remain the same (nextStep, recordVote, clearScore, resetVotes, submitVotes, calculateResults, viewSubmittedVotes, viewResultsDirectly)
    // ... (copy them from your previous working version)

    // Initialize
    
    render();
  </script>
</body>
</html>

